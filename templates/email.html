<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Email Scheduler</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 py-10">
    <div class="max-w-3xl mx-auto bg-white shadow-lg rounded-lg p-8 border border-gray-300">
        <h1 class="text-2xl font-semibold text-gray-800 mb-6">Schedule an Email</h1>

        <form method="post" class="space-y-6">
            {% csrf_token %}

            <!-- Subject -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Subject</label>
                <input type="text" name="subject"
                       class="w-full border border-gray-400 rounded px-3 py-2 text-sm focus:outline-none focus:border-gray-600"
                       required>
            </div>

            <!-- Body -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Body</label>
                <textarea name="body" rows="4"
                          class="w-full border border-gray-400 rounded px-3 py-2 text-sm focus:outline-none focus:border-gray-600"
                          required></textarea>
            </div>

            <!-- Recipient -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Recipient Email</label>
                <input type="email" name="recipient_email"
                       class="w-full border border-gray-400 rounded px-3 py-2 text-sm focus:outline-none focus:border-gray-600"
                       required>
            </div>

            <!-- Frequency as Buttons -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Frequency</label>
                <div class="grid grid-cols-4 gap-2 w-full">
                    <button type="button" onclick="setFrequency('hourly')" id="btn-hourly"
                        class="w-full border border-gray-400 rounded px-3 py-2 text-sm bg-white hover:bg-gray-100">
                        Hourly
                    </button>
                    <button type="button" onclick="setFrequency('daily')" id="btn-daily"
                        class="w-full border border-gray-400 rounded px-3 py-2 text-sm bg-white hover:bg-gray-100">
                        Daily
                    </button>
                    <button type="button" onclick="setFrequency('weekly')" id="btn-weekly"
                        class="w-full border border-gray-400 rounded px-3 py-2 text-sm bg-white hover:bg-gray-100">
                        Weekly
                    </button>
                    <button type="button" onclick="setFrequency('monthly')" id="btn-monthly"
                        class="w-full border border-gray-400 rounded px-3 py-2 text-sm bg-white hover:bg-gray-100">
                        Monthly
                    </button>
                </div>
                <input type="hidden" name="frequency" id="frequency" required>
            </div>

            <!-- Time -->
            <div id="time-field" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-1">Scheduled Time</label>
                <input type="time" name="scheduled_time"
                       class="w-full border border-gray-400 rounded px-3 py-2 text-sm focus:outline-none focus:border-gray-600">
            </div>

            <!-- Date -->
            <div id="date-field" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-1">Scheduled Date</label>
                <input type="date" name="scheduled_date"
                       class="w-full border border-gray-400 rounded px-3 py-2 text-sm focus:outline-none focus:border-gray-600">
            </div>

            <!-- Weekly -->
            <div id="weekly-field" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-1">Day of Week</label>
                <select name="scheduled_day"
                        class="w-full border border-gray-400 rounded px-3 py-2 text-sm focus:outline-none focus:border-gray-600">
                    <option value="">-- Select Day --</option>
                    <option value="monday">Monday</option>
                    <option value="tuesday">Tuesday</option>
                    <option value="wednesday">Wednesday</option>
                    <option value="thursday">Thursday</option>
                    <option value="friday">Friday</option>
                    <option value="saturday">Saturday</option>
                    <option value="sunday">Sunday</option>
                </select>
            </div>

            <!-- Monthly -->
            <div id="monthly-field" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-1">Day of Month</label>
                <input type="number" name="scheduled_day_month" min="1" max="31"
                       class="w-full border border-gray-400 rounded px-3 py-2 text-sm focus:outline-none focus:border-gray-600">
            </div>

            <!-- Submit -->
            <div>
                <button type="submit"
                        class="w-full bg-gray-700 text-white rounded px-4 py-2 text-sm hover:bg-gray-800 focus:outline-none">
                    Schedule Email
                </button>
            </div>
        </form>
    </div>

    <script>
        function setFrequency(value) {
            document.getElementById("frequency").value = value;

            // Reset button styles
            ["hourly","daily","weekly","monthly"].forEach(f => {
                const btn = document.getElementById("btn-" + f);
                btn.classList.remove("bg-gray-700", "text-white");
                btn.classList.add("bg-white", "text-gray-700");
            });

            // Highlight active button
            const activeBtn = document.getElementById("btn-" + value);
            activeBtn.classList.remove("bg-white", "text-gray-700");
            activeBtn.classList.add("bg-gray-700", "text-white");

            toggleFields();
        }

        function toggleFields() {
            const frequency = document.getElementById("frequency").value;

            // Hide all first
            document.getElementById("time-field").classList.add("hidden");
            document.getElementById("date-field").classList.add("hidden");
            document.getElementById("weekly-field").classList.add("hidden");
            document.getElementById("monthly-field").classList.add("hidden");

            if (frequency === "hourly") {
                document.getElementById("time-field").classList.remove("hidden");
                // no date for hourly
            } else if (frequency === "daily") {
                document.getElementById("time-field").classList.remove("hidden");
                document.getElementById("date-field").classList.remove("hidden");
            } else if (frequency === "weekly") {
                document.getElementById("time-field").classList.remove("hidden");
                document.getElementById("weekly-field").classList.remove("hidden");
            } else if (frequency === "monthly") {
                document.getElementById("time-field").classList.remove("hidden");
                document.getElementById("monthly-field").classList.remove("hidden");
            }
        }
    </script>
</body>
</html>
